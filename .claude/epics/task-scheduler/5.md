---
name: Multi-Objective Scorer
status: closed
created: 2026-01-17T09:00:24Z
updated: 2026-01-17T09:08:42Z
github: https://github.com/ebergstedt/ccpm-poc/issues/5
last_sync: 2026-01-17T10:09:08Z
depends_on: [3, 4]
parallel: false
conflicts_with: []
---

# Task: Multi-Objective Scorer

## Description

Implement the scoring function that evaluates potential worker assignments using multiple objectives: predicted wait time, worker utilization, and task priority. The scorer selects the optimal worker for each incoming task.

## Acceptance Criteria

- [ ] Score all healthy workers for a given task
- [ ] Balance wait time, utilization, and priority objectives
- [ ] Configurable weights (default: 0.4, 0.4, 0.2)
- [ ] Return best worker with score and reasoning
- [ ] Handle edge cases: no workers, all unhealthy, ties
- [ ] Log scoring decisions for debugging

## Technical Details

### Files to Create
- `src/scheduler/scorer/scorer.ts` - Main scoring logic
- `src/scheduler/scorer/objectives.ts` - Individual objective functions

### Scoring Formula
```typescript
interface ScoringInput {
  task: Task;
  worker: WorkerState;
  prediction: TaskPrediction;
}

function score(input: ScoringInput, weights: Weights): number {
  const { task, worker, prediction } = input;

  // Objective 1: Minimize wait time (higher is better)
  const waitScore = 1 - (worker.estimatedWaitMs / MAX_WAIT_MS);

  // Objective 2: Prefer less loaded workers (higher is better)
  const loadScore = 1 - worker.currentLoad;

  // Objective 3: Respect priority (normalized 0-1)
  const priorityScore = task.priority / MAX_PRIORITY;

  return weights.wait * waitScore
       + weights.load * loadScore
       + weights.priority * priorityScore;
}
```

### Configuration
```typescript
interface ScorerConfig {
  weights: {
    wait: number;      // Default: 0.4
    load: number;      // Default: 0.4
    priority: number;  // Default: 0.2
  };
  maxWaitMs: number;   // Default: 60000
  maxPriority: number; // Default: 10
}
```

### Decision Reasoning
```typescript
interface ScoringResult {
  workerId: string;
  score: number;
  reasoning: string; // e.g., "Selected worker-3: score=0.85 (wait=0.9, load=0.8, priority=0.5)"
  alternatives: Array<{ workerId: string; score: number }>;
}
```

## Dependencies

- [ ] Task 3: Heuristic Predictor (predictions)
- [ ] Task 4: Worker Capacity Tracking (worker states)

## Effort Estimate

- Size: S
- Hours: 4-6
- Parallel: false (depends on 3 and 4)

## Definition of Done

- [ ] Code implemented
- [ ] Unit tests for scoring with various inputs
- [ ] Test: correct worker selected in typical scenarios
- [ ] Test: graceful handling of edge cases
- [ ] Code reviewed
